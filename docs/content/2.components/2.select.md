# Select

:SelectDemo

## Default
`<RSelect />` is base component which will have `<ROption />` as default slot. value of each item will be on `value` prop of `ROption`.

::Demo
  :::CodeGroup
    ```vue [template]
    <template>
    <RSelect v-model="selected" placeholder="Placeholder" >
      <ROption v-for="{ name, id } in items" :value="id" :text="name" />
    </RSelect>
    </template>
    ```
    ```ts [script]
    const items = ref([
      { name: "Vue", id: 1 },
      { name: "React", id: 2 },
      { name: "Svelte", id: 3 },
      { name: "Nuxt", id: 4 },
      { name: "Node", id: 5 },
    ]);
    const selected = ref();
    ```
  :::
#demo
  :SelectDefault
::

## Custom Option
Default slot of `ROption` components lets you render your custom item. by default only `text` prop is shown. If you do not pass `text` prop you need to use `renderPlaceholder` to [customize the placeholder](#custom-placeholder) and if select is multiple you should use [custom selected items ( tags )](#custom-selected-items) as well.

::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <RSelect v-model="selected" placeholder="Custom Option" :renderPlaceholder="renderPlaceholder" label="single item">
        <ROption v-for="{ name, flag, id } in items" :value="id" :context="{ name, flag }">
          <div class="custom-option">
            <img :src="flag">
            <span>{{ name }}</span>
          </div>
        </ROption>
      </RSelect>
      <RSelect v-model="selectedMultiple"
        multiple
        placeholder="Custom Option"
        :renderPlaceholder="renderMultplePlaceholder"
        label="multiple item">
        <ROption v-for="{ name, flag, id } in items" :value="id" :context="{ name, flag }">
          <div class="custom-option">
            <img :src="flag">
            <span>{{ name }}</span>
          </div>
        </ROption>
        <template #selectedItem="{ context }">
          <div class="selected-item">
            <img :src="context.flag">
            <span>{{ context.name }}</span>
          </div>
        </template>
      </RSelect>
    </template>
    ```
    ```ts [script]
    import type { ROptionProps } from 'sevue'

    const items = ref([
      { name: "Germany", id: 1, flag: 'https://flagsapi.com/DE/flat/64.png' },
      { name: "Italy", id: 2, flag: 'https://flagsapi.com/IT/flat/64.png' },
      { name: "United Kingdom", id: 3, flag: 'https://flagsapi.com/GB/flat/64.png' },
      { name: "France", id: 4, flag: 'https://flagsapi.com/FR/flat/64.png' },
      { name: "Greece", id: 5, flag: 'https://flagsapi.com/GR/flat/64.png' },
    ]);
    const selected = ref('');
    const selectedMultiple = ref([]);

    const renderPlaceholder = (option: ROptionProps) => {
      return option.context.name
    }
    const renderMultplePlaceholder = (options: any) => {
      return `${options.length} items selected`
    }
    ```
  :::
#demo
  :SelectCustomOption
::

## Custom Placeholder
If you don't specify `text` on `ROption` you need to use a custom placeholder which is a function accepting selected option( when single select ) or array of selected options( when multiple select ) and returns a string to be displayed when any item is selected. defaults to:
```ts
renderPlaceholder: (option: Option | Option[]) => {
  if (Array.isArray(option)) return `${option.length} selected`
  else return option.text || ''
}
```


## Custom Selected Items
To show custom tags when selection is multiple you can use named slot of `#selectedItem` which accepts option props. `context` prop is used for passing custom data.


::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <RSelect v-model="selectedMultiple"
        multiple
        placeholder="Select Items"
        :renderPlaceholder="renderPlaceholder"
        label="Custom Selected Items">
        <ROption v-for="{ name, flag, id } in items" :value="id" :context="{ name, flag }">
          <div class="custom-option">
            <img :src="flag">
            <span>{{ name }}</span>
          </div>
        </ROption>
        <template #selectedItem="{ context }">
          <div class="selected-item">
            <img :src="context.flag">
            <span>{{ context.name }}</span>
          </div>
        </template>
      </RSelect>
    </template>
    ```
    ```ts [script]
      const items = ref([
        { name: "Germany", id: 1, flag: 'https://flagsapi.com/DE/flat/64.png' },
        { name: "Italy", id: 2, flag: 'https://flagsapi.com/IT/flat/64.png' },
        { name: "United Kingdom", id: 3, flag: 'https://flagsapi.com/GB/flat/64.png' },
        { name: "France", id: 4, flag: 'https://flagsapi.com/FR/flat/64.png' },
        { name: "Greece", id: 5, flag: 'https://flagsapi.com/GR/flat/64.png' },
      ]);
      const selectedMultiple = ref([]);

      const renderPlaceholder = (options: any) => {
        return `${options.length} items selected`
      }
    ```
  :::
#demo
  :SelectCustomSelectedItems
::


## Custom Search
By default `searchable` prop does search over `text` prop of `ROption`. If you don't pass `text` or want a different type of searching you can use `customSearch` prop which is a function and is called whenever the input changes accepting search query as it's parameter.


::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <RSelect
        v-model="selected"
        placeholder="Select Items"
        :renderPlaceholder="renderPlaceholder"
        searchable
        :customSearch="customSearh">
        <ROption v-for="{ name, flag, id } in filteredItems" :value="id" :context="{ name, flag }">
          <div class="custom-option">
            <img :src="flag">
            <span>{{ name }}</span>
          </div>
        </ROption>
      </RSelect>
    </template>
    ```
    ```ts [script]
    const items = ref([
      { name: "Germany", id: 1, flag: 'https://flagsapi.com/DE/flat/64.png' },
      { name: "Italy", id: 2, flag: 'https://flagsapi.com/IT/flat/64.png' },
      { name: "United Kingdom", id: 3, flag: 'https://flagsapi.com/GB/flat/64.png' },
      { name: "France", id: 4, flag: 'https://flagsapi.com/FR/flat/64.png' },
      { name: "Greece", id: 5, flag: 'https://flagsapi.com/GR/flat/64.png' },
    ]);
    const filteredItems = ref(items.value)
    const selected = ref();

    const customSearh = (search: string) => {
      filteredItems.value = items.value.filter(({ name }) => {
        return name.toLowerCase().includes(search.toLowerCase())
      })
    }

    const renderPlaceholder = (options: any) => {
      return options.context.name
    }
    ```
  :::
#demo
  :SelectCustomSearch
::



## Async items

Here is an example of using items that are fetched from an api. `noDropdownOnEmptySearch` hides dropdown when there is no search query.

::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <RSelect
        v-model="state.selected"
        placeholder="Select Items"
        :renderPlaceholder="renderPlaceholder"
        searchable
        multiple
        :loading="state.loading"
        noDropdownOnEmptySearch
        :customSearch="customSearh">
        <ROption v-for="item in state.users" :value="item.id" :context="item">
          <div class="custom-option">
            <span>{{ item.firstName }} {{ item.lastName }}</span>
          </div>
        </ROption>
        <template #selectedItem="{ context }">
          {{ context.firstName }} {{ context.lastName }}
        </template>
      </RSelect>
    </template>
    ```
    ```ts [script]
    import axios from "axios"

    interface State {
      users: { firstName: string, lastName: string, id: number }[]
      loading: boolean
      selected: number[]
    }
    const state = reactive<State>({
      users: [],
      loading: false,
      selected: []
    })


    const getUsers = async (search = '') => {
      state.loading = true
      const { data } = await axios.get('https://dummyjson.com/users/search', { params: { q: search } })
      state.loading = false
      return data.users
    }

    const customSearh = async (search: string) => {
      state.users = await getUsers(search)
      console.log(state);

    }

    const renderPlaceholder = (options: any) => {
      return `${options.length} users selected`
    }

    onMounted(async () => {
      state.users = await getUsers()
    })
    ```
  :::
#demo
  :SelectAsync
::


::Alert{type="warning"}
There are some cases where some options are pre-selected ( for example inital value of `v-model` is not empty ) but you don't have the list yet or values you have as initial modelValue are not on the list of your options, in this case you can use exposed method of `setSelectedItems` to pass the items to RSelect. The first parameter is the array of objects as you would pass props to `ROption`. <br /> this method does NOT modify `v-model`, it just updates selected items if there are any missing from options.
```vue
<RSelect ref="selectRef">...</RSelect>
```
```ts
import { RSelect } from 'sevue'
const selectRef = ref<InstanceOf<typeof RSelect> | undefined>()

// letting rselect know of items that are selected but are not on options list:
selectRef.value.setSelectedItems([
  {
    value: item.id // mandatory
    context: {} // to pass custom data you can later use for custom templating
  }
])
```
::


## `RSelectGroup`
Used when items are grouped.

::Demo
  :::CodeGroup
    ```vue [template]
    <template>
    <RSelect v-model="selected" placeholder="Select City">
      <RSelectGroup v-for="{ title, cities } in items" :title="title">
        <ROption v-for="{name, id} in cities" :value="id" :text="name" />
      </RSelectGroup>
    </RSelect>
    </template>
    ```
    ```ts [script]
    const items = ref([
      {
        title: "UK",
        cities: [
          { name: "London", id: 1 },
          { name: "Bristol", id: 2 },
        ],
      },
      {
        title: "Russia",
        cities: [
          { name: "Moscow", id: 3 },
          { name: "Saint Petersburg", id: 4 },
          { name: "Novosibirsk", id: 5 },
        ],
      },
    ]);
    const selected = ref();
    ```
  :::
#demo
  :SelectGroup
::

## Multiple
Initial value of `v-model` or `modelValue` needs to be and array.
`keepOpenAfterSelection` prevents the select from closing after value selection.
::Demo
  :::CodeGroup
    ```vue [template]
    <template>
    <RSelect v-model="selected" multiple keepOpenAfterSelection>
      <ROption v-for="{ name, id } in items" :value="id" :text="name" />
    </RSelect>
    </template>
    ```
    ```ts [script]
    const items = ref([
      { name: "Germany", id: 1 },
      { name: "Italy", id: 2 },
      { name: "United Kingdom", id: 3 },
      { name: "France", id: 4 },
      { name: "Greece", id: 5 },
    ]);
    const selected = ref([]);
    ```
  :::
#demo
  ::SelectMultiple
::


## Disabled
This prop can be passed to `RSelect` to disable the whole select or `ROption` to disable specific option/options.
::Demo
  :::CodeGroup
    ```vue [template]
    <template>
    <RSelect v-model="selected" :disabled="disabled">
      <ROption v-for="{ name, id } in items" :value="id" :text="name" />
    </RSelect>
    <RButton @click="disabled = !disabled">{{ disabled ? 'Enable' : 'Disable' }}</RButton>
    </template>
    ```
    ```ts [script]
    const items = ref([
      { name: "Germany", id: 1 },
      { name: "Italy", id: 2 },
      { name: "United Kingdom", id: 3 },
      { name: "France", id: 4 },
      { name: "Greece", id: 5 },
    ]);
    const selected = ref();
    const disabled = ref(true)
    ```
  :::
#demo
  ::SelectDisabled
::


## Optimized items

You might experience some lags when there are lots of items in your options list. You can optimize rendering of items using the method below:

You need to pass the main array of items to `items` prop of `RSelect`: `<RSelect :items="myLongList" />`. doing so you get a prop in default slot of RSelect called `optimizedItems`. you shall use this prop for rendering your list instead of `myLongList`.

items array must have `value` key in each item which is mandatory for setting values if not you can use `itemExtractor` prop. it recieves item as it's first parameter and must return an object containing at least `value` which will be used as `value` prop for `ROption`. this is equalant to passing props to `ROption`.

```vue
<template>
  <RSelect :items="myLongList" :itemExtractor="itemExtractor">
    <template #default="{ optimizedItems }">
      <ROption v-for="item in optimizedItems" :value="item.id" :text="item.title" />
    </template>
  </RSelect>
</template>

<script setup>
const itemExtractor = (item) => {
  return {
    ...item,
    value: item.id,
  };
};
</script>
```

::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <div class="doc-item">
        <RSelect v-model="selected" :items="items" :itemExtractor="itemExtractor" searchable label="Select with 10k items">
          <template #default="{ optimizedItems }">
            <ROption v-for="{ itemId, itemTitle } in optimizedItems" :value="itemId" :text="itemTitle" />
          </template>
        </RSelect>
      </div>
    </template>
    ```
    ```ts [script]
    type Item = {
      itemTitle: string;
      itemId: number;
    };

    const items = ref<Array<Item>>(
      Array.from({ length: 10000 }, (_, i) => {
        return {
          itemTitle: `item #${i}`,
          itemId: i,
        };
      })
    );
    const selected = ref();
    const itemExtractor = (item: Item) => {
      return {
        ...item,
        value: item.itemId,
        text: item.itemTitle,
      };
    };
    ```
  :::
#demo
  ::SelectOptimized
::


### Controlling the optimized list

The list you receive as `optimizedList` is being filtered based on a page state which is being increased each time user reaches end of the dropdown list. to customize the parameters you can use `perPage` and `paginationOffset` props. both are numbers and default to `10` (page) and `40` (paginationOffset)

### Usage for grouped items

When you items are grouped ( for example `Country[].City[]` ) you can still use paginated list with same props described earlier plus you also need to speicfy `itemsKey (default: 'items')` and `groupIdentifier (default: 'id')`. `itemsKey` is the key where the nested items are located and `groupIdentifier` is the key to a property which is unique to each group. For example if we want to use in the following example as select items
```js
[
  {
    title: "UK",
    cities: [
      { name: "London", id: 1 }, { name: "Bristol", id: 2 }
    ],
  },
  {
    title: "Russia",
    cities: [
      { name: "Moscow", id: 3 }, { name: "Saint Petersburg", id: 4 }, { name: "Novosibirsk", id: 5 }
    ],
  },
]
```
we should pass `itemsKey="cities"` and `groupIdentifier="title"`. so the result will look something like this:

```vue
<template>
  <RSelect :items="myLongItems" groupIdentifier="title" itemsKey="cities" :itemExtractor="itemExtractor">
    <template #default="{ optimizedItems }">
      <ROption v-for="item in optimizedItems" :value="item.id" :text="item.title" />
    </template>
  </RSelect>
</template>

<script setup>
const myLongItems = ref([
  {
    title: "UK",
    cities: [
      { name: "London", id: 1 }, { name: "Bristol", id: 2 }
    ],
  },
  {
    title: "Russia",
    cities: [
      { name: "Moscow", id: 3 }, { name: "Saint Petersburg", id: 4 }, { name: "Novosibirsk", id: 5 }
    ],
  },
])

const itemExtractor = (item) => {
  return {
    ...item,
    value: item.id,
    text: item.title
  };
};
</script>
```


::Demo
  :::CodeGroup
    ```vue [template]
    <template>
      <RSelect
        v-model="selected"
        :items="items"
        :itemExtractor="itemExtractor"
        searchable
        label="Select with 1k items 10 children each"
        groupIdentifier="groupUniqueId"
        itemsKey="children"
      >
        <template #default="{ optimizedItems }">
          <RSelectGroup v-for="item in optimizedItems" :title="item.title">
            <ROption v-for="child in item.children" :value="child.itemValue" :text="child.itemText" />
          </RSelectGroup>
        </template>
      </RSelect>
    </template>
    ```
    ```ts [script]
    type Item = {
      itemValue: string;
      itemText: string;
    };

    type Group = {
      groupUniqueId: number;
      title: string;
      children: Item[];
    };

    const items = ref<Group[]>(
      Array.from({ length: 1000 }, (_, i) => {
        return {
          groupUniqueId: i,
          title: `Group ${i}`,
          children: Array.from({ length: 10 }, (_, childIndex) => {
            return {
              itemValue: `${i} - ${childIndex}`,
              itemText: `Item #${i} - ${childIndex}`,
            };
          }),
        };
      })
    );

    const selected = ref();

    const itemExtractor = (item: Item) => {
      return {
        ...item,
        value: item.itemValue,
        text: item.itemText,
      };
    };
    ```
  :::
#demo
  ::SelectOptimizedGrouped
::



## State
Refer to [Input State](/components/input#states)

## Props
| Name                    | Type                                       | Required | Default Value                             | Description                                                                                                           |
| ----------------------- | ------------------------------------------ | -------- | ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------- |
| searchable              | boolean                                    | No       | false                                     | If true, allows users to search for and select options from a dropdown menu.                                          |
| multiple                | boolean                                    | No       | false                                     | If true, allows users to select multiple options from the dropdown menu.                                              |
| modelValue              | array \| number \| string                  | Yes      | undefined                                 | The selected value(s) of the dropdown menu. If multiple is set to true, an array of values is expected.               |
| placeholder             | string                                     | No       | ""                                        | The text displayed inside the dropdown menu when no options are selected.                                             |
| disabled                | boolean                                    | No       | false                                     | If true, disables the dropdown menu.                                                                                  |
| label                   | string                                     | No       | undefined                                 | The label displayed above the dropdown menu.                                                                          |
| keepOpenAfterSelection  | boolean                                    | No       | false                                     | If true, keeps the dropdown menu open after a selection has been made.                                                |
| color                   | string                                     | No       | undefined                                 | The color of the Select.                                                                                              |
| error                   | boolean                                    | No       | false                                     | If true, adds error styling.                                                                                          |
| message                 | string                                     | No       | undefined                                 | The message displayed below the dropdown menu.                                                                        |
| inputProps              | object of any                              | No       | undefined                                 | Props to pass down to input                                                                                           |
| noDropdownOnEmptySearch | boolean                                    | No       | undefined                                 | When search value is empty dropdown will not show (or hide of it is was open)                                         |
| loading                 | boolean                                    | No       | undefined                                 | Loading state on select ( shows a spinner instead of chevron )                                                        |
| renderPlaceholder       | (parameter: Option \| Option\[]) => string | No       | [Custom Placeholder](#custom-placeholder) | When some value is seleted this placeholder will be shown                                                             |
| customSearch            | (parameter: string) => void                | No       | undefined                                 | called when input text changes. you can use this function to filter your items from an API or change search behaviour |
| items            | Array<any>                | No       | undefined                                 | if provided will [Optimized Items](#optimized-items) will be used |
| itemsKey            | string                | No       | 'items'                                 | used for when using optimized items and list is nested ( grouped ) [Usage for grouped items](#usage-for-grouped-items) |
| groupIdentifier            | string                | No       | 'id'                                 | used for when using optimized items and list is nested ( grouped ) [Usage for grouped items](#usage-for-grouped-items) |
| paginationOffset            | number                | No       | 40                                 | distance from bottom in pixels to trigger rendering new items |
| perPage            | number                | No       | 10                                 | number of items per page on optimized list |
| itemExtractor            | (parameter: any) => Option                | No       | undefined                                 | used when format of item do not match the format of `ROption` props ( missing `value` ): [Optimized Items](#optimized-items) |


## Events
| Event              | Arguments | Description                                    |
| ------------------ | --------- | ---------------------------------------------- |
| open               | -         | Called when dropdown opens.                    |
| close              | -         | Called when dropdown closes.                   |
| afterTransitionEnd | -         | Called when dropdown close transition is done. |
| search             | -         | Called search input value changes.             |

## RSelect Slots
| Name         | slot props             | description                                     |
| ------------ | ---------------------- | ----------------------------------------------- |
| default      | -                      | For rendering `ROption` or `RSelectGroup`.      |
| selectedItem | {value, text, context} | For rendering custom tags on multiple selection |
| noItems      | -                      | When there are no options                       |